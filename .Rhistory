legned(2005,95)
legend(2005,95)
legend(2005,95,c("RT","IMDb"),lty=c(1,1),lwd=c(2.5,2.5),col=c(“black”,”red”))
legend(2005,95,c("RT","IMDb"),lty=c(1,1),lwd=c(2,2),col=c(“black”,”red”))
legend(2005,95,c("RT","IMDb"),lty=c(1,1),lwd=c(2,2),col=c("black","red"))
library(rvest)
require(XML)
library(ggplot2)
library(plotrix)
twoord.plot(lx = rtbyyear$year, rx = imdbbyyear$year, ly = rtbyyear$tomatoMeter,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings",  xlim=c(1976,2016)
,type=c("l","l"), lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
legend(2005,95,c("RT","IMDb"),lty=c(1,1),lwd=c(2,2),col=c("black","red"))
head(rtbyyear)
rt.lm <- lm(tomatoMeter~year, data=rtbyyear)
abline(rt.lm)
rt.lm
head(movie.df.final)
metascorebyyear <- aggregate(metascore ~ year, data=movie.df.final, mean)
warnings()
movie.df.final$metascore <- as.numeric(movie.df.final$metascore)
movie.df.final <- movie.df.final[!is.na(movie.df.final$metascore)]
movie.df.final <- movie.df.final[!is.na(movie.df.final$metascore),]
rtbyyear <- aggregate(tomatoMeter ~ year, data=movie.df.final, mean)
imdbbyyear <- aggregate(imdbRating ~ year, data=movie.df.final, mean)
metascorebyyear <- aggregate(metascore ~ year, data=movie.df.final, mean)
rtbyyear <- rtbyyear[-c(35),]
imdbbyyear <- imdbbyyear[-c(35),]
metascorebyyear <- metascorebyyear[-c(35),]
rt.lm <- lm(tomatoMeter~year, data=rtbyyear)
head(metascorebyyear)
lines(metascorebyyear$year,metascorebyyear$metascore, col="gree")
lines(metascorebyyear$year,metascorebyyear$metascore, col="green")
lines(metascorebyyear$year,metascorebyyear$metascore, col="green",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("black","red","green"))
# line plot
twoord.plot(lx = rtbyyear$year, rx = imdbbyyear$year, ly = rtbyyear$tomatoMeter,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1976,2016)
,type=c("l","l"), lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
lines(metascorebyyear$year,metascorebyyear$metascore, col="green",lwd=2)
head(rtbyyear, 20)
table(movie.df.final$year)
abline(v=1999, lty=4, col="green")
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("black","red","green"))
table(movie.df.final$year)[,1]
table(movie.df.final$year)[1]
rt.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$tomatoMeter), ]
imdb.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$imdbRating),]
metascore.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$metascore),]
mc.splits <- split(metascore.top, metascore.top$year)
rt.splits<-split(rt.top,rt.top$year)
rt.df <-lapply(rt.splits,head,12)
rt.top <- do.call(rbind.data.frame,rt.df)
imdb.splits <- split(imdb.top,imdb.top$year)
imdb.df <- lapply(imdb.splits,head,12)
imdb.top <- do.call(rbind.data.frame,imdb.df)
mc.splits <- split(metascore.top, metascore.top$year)
mc.df <- lapply(mc.splits,head,12)
mc.df <- do.call(rbind.daat.frame,mc.df)
mc.df <- do.call(rbind.data.frame,mc.df)
rt.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$tomatoMeter), ]
imdb.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$imdbRating),]
metascore.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$metascore),]
rt.splits<-split(rt.top,rt.top$year)
rt.df <-lapply(rt.splits,head,12)
rt.top <- do.call(rbind.data.frame,rt.df)
imdb.splits <- split(imdb.top,imdb.top$year)
imdb.df <- lapply(imdb.splits,head,12)
imdb.top <- do.call(rbind.data.frame,imdb.df)
mc.splits <- split(metascore.top, metascore.top$year)
mc.df <- lapply(mc.splits,head,12)
mc.top <- do.call(rbind.data.frame,mc.df)
rtbyyear.top <- aggregate(tomatoMeter ~ year, data=rt.top, mean)
imdbbyyear.top <- aggregate(imdbRating ~ year, data=imdb.top, mean)
mcbyyear.top <- aggregate(metascore ~ year, data=mc.top, mean)
mcbyyear.top <- mcbyyear.top[-c(35),]
mcbyyear.top
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="green",lwd=2)
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1970,2016),
type=c("l","l"), lwd=2)
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
rt.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$tomatoMeter), ]
imdb.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$imdbRating),]
metascore.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$metascore),]
rt.splits<-split(rt.top,rt.top$year)
rt.df <-lapply(rt.splits,head,20)
rt.top <- do.call(rbind.data.frame,rt.df)
imdb.splits <- split(imdb.top,imdb.top$year)
imdb.df <- lapply(imdb.splits,head,20)
imdb.top <- do.call(rbind.data.frame,imdb.df)
mc.splits <- split(metascore.top, metascore.top$year)
mc.df <- lapply(mc.splits,head,20)
mc.top <- do.call(rbind.data.frame,mc.df)
rtbyyear.top <- aggregate(tomatoMeter ~ year, data=rt.top, mean)
imdbbyyear.top <- aggregate(imdbRating ~ year, data=imdb.top, mean)
mcbyyear.top <- aggregate(metascore ~ year, data=mc.top, mean)
rtbyyear.top <- rtbyyear.top[-c(35),]
imdbbyyear.top <- imdbbyyear.top[-c(35),]
mcbyyear.top <- mcbyyear.top[-c(35),]
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1970,2016),
type=c("l","l"), lwd=2)
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
rtbyyear
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1979,2015),
type=c("l","l"), lwd=2)
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="green",lwd=2)
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(rtbyyear.top$year,rtbyyear.top$TomatoMeter, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
lines(rtbyyear.top$year,rtbyyear.top$TomatoMeter, col="green",lwd=2)
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
rtbyyear
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 25 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(rtbyyear.top$year,rtbyyear.top$TomatoMeter, col="green",lwd=2)
rt.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$tomatoMeter), ]
imdb.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$imdbRating),]
metascore.top <- movie.df.final[ order(movie.df.final$year, -movie.df.final$metascore),]
rt.splits<-split(rt.top,rt.top$year)
rt.df <-lapply(rt.splits,head,10)
rt.top <- do.call(rbind.data.frame,rt.df)
imdb.splits <- split(imdb.top,imdb.top$year)
imdb.df <- lapply(imdb.splits,head,10)
imdb.top <- do.call(rbind.data.frame,imdb.df)
mc.splits <- split(metascore.top, metascore.top$year)
mc.df <- lapply(mc.splits,head,10)
mc.top <- do.call(rbind.data.frame,mc.df)
rtbyyear.top <- aggregate(tomatoMeter ~ year, data=rt.top, mean)
imdbbyyear.top <- aggregate(imdbRating ~ year, data=imdb.top, mean)
mcbyyear.top <- aggregate(metascore ~ year, data=mc.top, mean)
rtbyyear.top <- rtbyyear.top[-c(35),]
imdbbyyear.top <- imdbbyyear.top[-c(35),]
mcbyyear.top <- mcbyyear.top[-c(35),]
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 15 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(rtbyyear.top$year,rtbyyear.top$TomatoMeter, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
rtbyyear.top
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="green",lwd=2)
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
# line plot
twoord.plot(lx = rtbyyear$year, rx = imdbbyyear$year, ly = rtbyyear$tomatoMeter,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(metascorebyyear$year,metascorebyyear$metascore, col="green",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("black","red","green"))
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2)
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="green",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="black")
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","black","green"))
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","black","green"))
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green")
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
twoord.plot(lx = rtybyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(67,100))
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(67,100))
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="red",lwd=2)
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
twoord.plot(lx = rtbyyear.top$year, rx = imdbbyyear.top$year, ly = rtbyyear.top$tomatoMeter,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green")
lines(mcbyyear.top$year,mcbyyear.top$metascore, col="red",lwd=2)
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
twoord.plot(lx = mcbyyear$year, rx = imdbbyyear$year, ly = mcbyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2)
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="green",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("black","red","green"))
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(45,100))
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="green",lwd=2)
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(50,100))
abline(v=1998, lty=4)
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100))
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="green",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("black","red","green"))
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="green",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("black","red","green"))
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("black","red","green"))
# chart only top movies
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
unique(movie.df.final$year)
library(rvest)
require(XML)
library(ggplot2)
library(plotrix)
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings, 1980-2016",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
movie.df.final[1:5,]
movie.df.final[8000:8005,]
movie.df.final[5000:5005,]
movie.df.final[4000:40005,]
movie.df.final[4000:4005,]
movie.df.final[4006:4010,]
movie.df.final[4011:4018,]
movie.df.final[4019:4025,]
movie.df.final[4026:4035,]
movie.df.final[4036:4045,]
movie.df.final[4046:4055,]
movie.df.final[movie.df.final$year="1995",]
movie.df.final[movie.df.final$year=="1995",]
head(movie.df.final[movie.df.final$year=="1995",])
movie.df.final[1089:1090,]
movie.df.final[884,]
head(movie.df.final[movie.df.final$year=="1995",])
movie.df.final[movie.df.final$year=="1995",]
View(movie.df.final)
View(movie.df.final)
movies1995 <- movie.df.final[movie.df.final$year=="1995",]
movies1993 <- movie.df.final[movie.df.final$year=="1993",]
rm(movies.1995)
rm(movies1995)
View(movies1993)
View(movies1993)
table(movie.df.final$year)
barplot(table(movie.df.final$year))
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings, 1980-2016",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dim(movie.df.final)
getwd()
setwd("movieratings")
png("average movie ratings", width=800, height=600, units="px")
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings, 1980-2016",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("average movie ratings", width=800, height=600, units="px")
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("top 12 movie ratings", width=800, height=600, units="px")
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("average movie ratings", width=800, height=600, units="px")
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings, 1980-2016",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
barplot(table(movie.df.final$year))
barplot(table(movie.df.final$year), main="Number of movies by year (OMDb w/ ratings from all 3 sites)")
barplot(table(movie.df.final$year), main="Number of movies by year (w/ ratings from all 3 sites)")
png("number of movies by year", width=800, height=600, units="px")
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings, 1980-2016",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("average movie ratings", width=800, height=600, units="px")
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings, 1980-2016",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("top 12 movie ratings", width=800, height=600, units="px")
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("top 12 movie ratings", width=800, height=600, units="px")
barplot(table(movie.df.final$year), main="Number of movies by year (w/ ratings from all 3 sites)")
dev.off()
png("number of movies by year", width=800, height=600, units="px")
barplot(table(movie.df.final$year), main="Number of movies by year (w/ ratings from all 3 sites)")
dev.off()
png("top 12 movie ratings", width=800, height=600, units="px")
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("number of movies by year.png", width=800, height=600, units="px")
barplot(table(movie.df.final$year), main="Number of movies by year (w/ ratings from all 3 sites)")
dev.off()
png("top 12 movie ratings.png", width=800, height=600, units="px")
twoord.plot(lx = mcbyyear.top$year, rx = imdbbyyear.top$year, ly = mcbyyear.top$metascore,
ry = imdbbyyear.top$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings of top 12 rated movies", xlim=c(1980,2015),
type=c("l","l"), lwd=2, lcol="blue", rcol="green", lylim=c(65,100))
lines(rtbyyear.top$year,rtbyyear.top$tomatoMeter, col="red",lwd=2)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, col="green", lty=4)
legend(2001,82,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
png("average movie ratings.png", width=800, height=600, units="px")
twoord.plot(lx = metascorebyyear$year, rx = imdbbyyear$year, ly = metascorebyyear$metascore,
ry = imdbbyyear$imdbRating, rylab = "IMDb Rating", ylab = "TomatoMeter and Metascore",
xlab = "Year", main = "Average movie ratings, 1980-2016",  xlim=c(1980,2015)
,type=c("l","l"), lwd=2, lylim=c(47,100),lcol="blue", rcol="green",)
abline(v=1998, lty=4)
abline(v=1996, col="red", lty=4)
abline(v=1999, lty=4, col="green")
lines(rtbyyear$year,rtbyyear$tomatoMeter, col="red",lwd=2)
legend(2005,95,c("RT","IMDb","MC"),lty=c(1,1),lwd=c(2,2),col=c("red","green","blue"))
dev.off()
